<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>shadowdsp</title>
  
  <subtitle>我的青春Coding物语果然有问题</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://shadowdsp.github.io/"/>
  <updated>2019-09-15T04:37:47.239Z</updated>
  <id>http://shadowdsp.github.io/</id>
  
  <author>
    <name>shadowdsp</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Python中的文本和字节字符串</title>
    <link href="http://shadowdsp.github.io/2019/09/15/Python%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC%E5%92%8C%E5%AD%97%E8%8A%82%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    <id>http://shadowdsp.github.io/2019/09/15/Python中的文本和字节字符串/</id>
    <published>2019-09-15T04:27:13.000Z</published>
    <updated>2019-09-15T04:37:47.239Z</updated>
    
    <content type="html"><![CDATA[<h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>最近工作中的项目同时使用到了 Python2 和 Python3 ，遇到了字符和字节上面的 tricks，自己之前对这方面不太了解，学习并总结一下。</p><h2 id="编码介绍"><a href="#编码介绍" class="headerlink" title="编码介绍"></a>编码介绍</h2><h3 id="Unicode标准"><a href="#Unicode标准" class="headerlink" title="Unicode标准"></a>Unicode标准</h3><p>Unicode 标准是用于表示文本以供计算机进行处理的通用字符编码标准。Unicode 标准提供了一种对多语种纯文本进行一致编码的方法，便于国际文本文件的交换。<strong>字符</strong> 的最佳定义是 <strong>Unicode 字符</strong> 。Unicode 只是一个符号集，它只规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。</p><h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><p>ASCII 是一套对<strong>英文字符</strong>与二进制位之间的关系做了统一规定的字符编码。ASCII 码规定了 128 个字符的编码，一个字节是 8 位，2^8=256位，因此在 ASCII 编码下，一个字符占一个字节，由于只占后 7 位，因此字节的最前面一位统一规定为 0。</p><h3 id="UTF-8"><a href="#UTF-8" class="headerlink" title="UTF-8"></a>UTF-8</h3><p><strong>UTF-8 字符编码是 Unicode 的实现方式之一。</strong></p><p>UTF-8 是一种变长的编码方式，它可以使用1~4个字节表示一个符号，根据不同的符号而变化字节长度。</p><p>以上更多详细的可以参考 <a href="http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html" target="_blank" rel="noopener">字符编码笔记</a></p><h2 id="Python-中的文本和字节"><a href="#Python-中的文本和字节" class="headerlink" title="Python 中的文本和字节"></a>Python 中的文本和字节</h2><p>在 Python3 中从 str 对象中获取的元素就是 Unicode 字符，可以通过 <strong>编码(encode)</strong> 将 <strong>字符</strong> 转化为 <strong>字节</strong>。 Python2 的 str 对象中获取的是原始字节序列，只有通过 <strong>解码(decode)</strong> 才能将 <strong>字节</strong> 转化为 <strong>字符</strong> 。</p><p>下面使用两个版本的 Python 对字符串进行操作：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># py3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">str</span>'&gt;  # 字符序列</span></span><br><span class="line">&gt;&gt;&gt; b = s.encode('utf-8')</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="string">b'123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(b)</span><br><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">bytes</span>'&gt; # 字节序列</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># py2</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = <span class="string">'123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(s)</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt; <span class="comment"># 这里是字节序列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b = s.encode(<span class="string">'utf-8'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b</span><br><span class="line"><span class="string">'123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(b)</span><br><span class="line">&lt;type <span class="string">'str'</span>&gt; <span class="comment"># 这里还是字节序列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>b.decode() <span class="comment"># decode 出来的才是字符序列</span></span><br><span class="line"><span class="string">u'123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>type(b.decode())</span><br><span class="line">&lt;type <span class="string">'unicode'</span>&gt; <span class="comment"># 字符序列</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = <span class="string">'一二三'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c</span><br><span class="line"><span class="string">'\xe4\xb8\x80\xe4\xba\x8c\xe4\xb8\x89'</span></span><br></pre></td></tr></table></figure><p>从上面的程序可以总结出 Python2 和 Python3 对于字符串处理上的区别：</p><table><thead><tr><th></th><th>Python2</th><th>Python3</th></tr></thead><tbody><tr><td>Unicode strings</td><td>unicode</td><td>str</td></tr><tr><td>Bytes strings</td><td>str</td><td>bytes</td></tr></tbody></table><h2 id="Python-中的-u-b-r"><a href="#Python-中的-u-b-r" class="headerlink" title="Python 中的 u, b, r"></a>Python 中的 <code>u</code>, <code>b</code>, <code>r</code></h2><p>Python 的字符串有时候前面会加一个 <code>u</code> ，<code>r</code> 或者 <code>b</code> 。</p><p><code>u</code> ：表示字符串是 <strong>Unicode</strong> 编码。结合上面表格的结论，可以认为：在 Python3 中，字符串前面是否加 <code>u</code> 的效果是一致的。在 Python2 中，字符串前面加 <code>u</code> 表示 Unicode 字符串，不加 <code>u</code> 表示 bytes。</p><p><code>b</code> ：表示字符串是 <strong>Bytes</strong>。同结合上面表格的结论，可以认为：在 Python2 中，字符串前面是否加 <code>b</code> 的效果是一致的。在 Python3 中，字符串前面加 <code>b</code> 表示 bytes，不加 <code>b</code> 表示 Unicode 字符串。</p><p><code>r</code> ：表示字符串是 <strong>原始字符串(raw string)</strong> ，里面的字符都是 <strong>raw string literals</strong> ，与 <code>Unicode</code> 和 <code>Bytes</code> 无关，因此 Python2 和 Python3 中含义是一致的。它的作用是使字符串   不会对诸如 <code>\n</code>, <code>\t</code> 等转义字符进行转义：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2 = <span class="string">'123\n123\t123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s2</span><br><span class="line"><span class="string">'123\n123\t123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1 = <span class="string">r'123\n123\t123'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s1</span><br><span class="line"><span class="string">'123\\n123\\t123'</span></span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>字符串处理方面因为现在 Python2 和 Python3 是并存的（不过 2020 年官方就不更新 Python2 了），所以容易混淆，但是总结了一下就清晰不少。</p><p>在这方面要写出兼容的代码，其实只需要使用 <code>__future__</code> 模块：</p><p><code>from __future__ import unicode_literal</code> </p><p>作用是：像 Python3 一样，字符串字面量的类型为文本，而不是字节。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h2&gt;&lt;p&gt;最近工作中的项目同时使用到了 Python2 和 Python3 ，遇到了字符和字节上面的 tricks，自己之前对这方面不太了解，学习并总
      
    
    </summary>
    
      <category term="Python" scheme="http://shadowdsp.github.io/categories/Python/"/>
    
    
      <category term="Python" scheme="http://shadowdsp.github.io/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>js中异步获取文件集并返回结果集</title>
    <link href="http://shadowdsp.github.io/2019/01/20/js%E4%B8%AD%E5%BC%82%E6%AD%A5%E8%8E%B7%E5%8F%96%E6%96%87%E4%BB%B6%E9%9B%86%E5%B9%B6%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E9%9B%86/"/>
    <id>http://shadowdsp.github.io/2019/01/20/js中异步获取文件集并返回结果集/</id>
    <published>2019-01-20T13:27:50.000Z</published>
    <updated>2019-01-20T13:37:58.565Z</updated>
    
    <content type="html"><![CDATA[<h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>最近在使用js中经常遇到需要去异步获取文件并对文件内容进行处理的需求。</p><p>详细的需求是：同时去异步获取多个文件，然后将多个文件的结果聚合起来，返回。</p><p>但是关于这样的做法有不少的实现方式，在这里主要做一个总结。</p><h1 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h1><p>我先在项目中放置了两个需要获取的json文件。</p><p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fzcxkhbgfzj30bk0diglo.jpg" alt=""></p><blockquote><p>a.json</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"a"</span>: <span class="string">"1"</span>,</span><br><span class="line">  <span class="attr">"b"</span>: <span class="string">"2"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>b.json</p></blockquote><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"c"</span>: <span class="string">"3"</span>,</span><br><span class="line">  <span class="attr">"d"</span>: <span class="string">"4"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>接下来开始获取这两个文件。</p><h2 id="只使用-Promise-then"><a href="#只使用-Promise-then" class="headerlink" title="只使用 Promise/then"></a>只使用 Promise/then</h2><h3 id="Promise-then介绍"><a href="#Promise-then介绍" class="headerlink" title="Promise/then介绍"></a>Promise/then介绍</h3><p><a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">Promise介绍</a></p><p>关于 Promise，可以看上面的链接，介绍的十分详细。</p><p>Promise有一个resolve()方法，将Promise对象的pending状态转化为resolved状态，并将操作的结果作为参数传递出去：例如 <code>new Promise((resolve, reject) =&gt; { resolve(&#39;123&#39;) })</code>，这里会将<code>&#39;123&#39;</code>作为Promise的结果传递出去。</p><p>接着可以用then方法去获取结果。then方法只能跟在Promise的后面，因此then方法的两个形参分别是Promise的resolve()方法传入的参数和reject()方法传入的参数。</p><p>一个小例子：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123; resolve(<span class="string">'123'</span>) &#125;)</span><br><span class="line">promise.then(<span class="function"><span class="params">data</span> =&gt;</span> <span class="built_in">console</span>.log(data))</span><br><span class="line"><span class="comment">// 123</span></span><br></pre></td></tr></table></figure><h3 id="实现异步"><a href="#实现异步" class="headerlink" title="实现异步"></a>实现异步</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> files = [<span class="string">'./data/a.json'</span>, <span class="string">'./data/b.json'</span>] <span class="comment">// 放在相对于index.html目录下的两个json文件</span></span><br><span class="line"><span class="keyword">let</span> promises = files.map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        fetch(file).then(<span class="function">(<span class="params">resp</span>) =&gt;</span> &#123;</span><br><span class="line">            resolve(resp.json()) <span class="comment">// resp.json() is a promise，resolve(resp.json())将包含的文件结果的promise传递出去</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'A : '</span>, promises) <span class="comment">// two promises</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">A :  </span></span><br><span class="line"><span class="comment">(2) [Promise, Promise]</span></span><br><span class="line"><span class="comment">    0: Promise</span></span><br><span class="line"><span class="comment">      [[PromiseStatus]]: "resolved"</span></span><br><span class="line"><span class="comment">      [[PromiseValue]]: Object</span></span><br><span class="line"><span class="comment">        a: "1"</span></span><br><span class="line"><span class="comment">        b: "2"</span></span><br><span class="line"><span class="comment">    1: Promise &#123;&lt;resolved&gt;: &#123;…&#125;&#125;</span></span><br><span class="line"><span class="comment">    length: 2</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Promise.all()将promises数组转化为一个promise，并获取promises内部的promise的返回值，并将返回值以一个数组的形式传递出去</span></span><br><span class="line"><span class="built_in">Promise</span>.all(promises).then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123; <span class="built_in">console</span>.log(results) &#125;)</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">(2) [&#123;…&#125;, &#123;…&#125;]</span></span><br><span class="line"><span class="comment">    0:</span></span><br><span class="line"><span class="comment">    a: "1"</span></span><br><span class="line"><span class="comment">    b: "2"</span></span><br><span class="line"><span class="comment">1:</span></span><br><span class="line"><span class="comment">    c: "3"</span></span><br><span class="line"><span class="comment">    d: "4"</span></span><br><span class="line"><span class="comment">length: 2</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="使用async-await"><a href="#使用async-await" class="headerlink" title="使用async/await"></a>使用async/await</h2><p>使用async函数之前可能还需要了解一下Generator函数。</p><h3 id="Generator函数介绍"><a href="#Generator函数介绍" class="headerlink" title="Generator函数介绍"></a>Generator函数介绍</h3><p>Generator函数不同于普通的函数。它在函数名前面会有一个<code>*</code>的标志，而且内部可以使用<code>yeild</code>使得Generator函数具有一些状态，不会一次执行完毕。</p><p>Generator函数可以通过调用<code>next()</code>方法执行到下一个<code>yeild</code>，每次会返回一个包含<code>{value: , done: }</code>的对象，为<code>yeild</code>后面的表达式的结果。可以给<code>next()</code>函数传递值，使得这个值为上一个<code>yeild</code>表达式的返回结果。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span>* <span class="title">genFunc</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> resA = <span class="keyword">yield</span> <span class="string">'1'</span></span><br><span class="line">    <span class="built_in">console</span>.log(resA)</span><br><span class="line">    <span class="keyword">let</span> resB = <span class="keyword">yield</span> <span class="string">'2'</span></span><br><span class="line">    <span class="built_in">console</span>.log(resB)</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'3'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 此时还未执行gen()</span></span><br><span class="line"><span class="keyword">let</span> gen = genFunc()</span><br><span class="line"><span class="comment">// 开始执行第一个yield(yield '1')</span></span><br><span class="line"><span class="built_in">console</span>.log(gen.next())</span><br><span class="line"><span class="comment">// 执行第二个yeild(yield '2')，传入的参数为上一个yield的返回值，因此genFunc()中的resA='A'</span></span><br><span class="line"><span class="built_in">console</span>.log(gen.next(<span class="string">'A'</span>))</span><br><span class="line"><span class="comment">// 执行第三个yeild(return '3')，resB的值与上面同理</span></span><br><span class="line"><span class="built_in">console</span>.log(gen.next(<span class="string">'B'</span>))</span><br></pre></td></tr></table></figure><p>结果：</p><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fzczojv8eij30di0e4q35.jpg" alt=""></p><h3 id="async-await介绍"><a href="#async-await介绍" class="headerlink" title="async/await介绍"></a>async/await介绍</h3><p><a href="http://es6.ruanyifeng.com/#docs/async" target="_blank" rel="noopener">async函数介绍</a></p><p>async/await主要是将Generator函数的<code>*</code>替换为<code>async</code>，将<code>yield</code>替换为<code>await</code>，而且<code>await</code>后面需要跟<code>promise</code>，并且等待其执行完成，得到其执行结果；如果不是<code>promise</code>的话，会立即返回其值。另外<code>async</code>函数的返回值是一个<code>promise</code>。</p><h3 id="实现异步-1"><a href="#实现异步-1" class="headerlink" title="实现异步"></a>实现异步</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> files = [<span class="string">'./data/a.json'</span>, <span class="string">'./data/b.json'</span>]</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchFilesData</span>(<span class="params">files</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> promises = files.map(<span class="keyword">async</span> (file) =&gt; &#123;</span><br><span class="line">        <span class="keyword">let</span> resp = <span class="keyword">await</span> fetch(file) <span class="comment">// 此时await等待fetch的结果，但是这个过程是并发fetch</span></span><br><span class="line">        <span class="keyword">return</span> resp.json()</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.all(promises) <span class="comment">// 此时await等待并获取了Promise.all()的执行结果</span></span><br><span class="line">&#125;</span><br><span class="line">fetchFilesData(files).then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123; <span class="built_in">console</span>.log(results) &#125;) <span class="comment">// 最后这里还是用.then()去获取，不知道是否存在不用.then()的方法</span></span><br></pre></td></tr></table></figure><p>结果：</p><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fzdakdiruyj304t02j743.jpg" alt=""></p><h2 id="使用axios替代fetch"><a href="#使用axios替代fetch" class="headerlink" title="使用axios替代fetch"></a>使用axios替代fetch</h2><p>听同学说用<code>axios</code>替代<code>fetch</code>会更好，经过查阅资料，主要是有<code>axios</code>从浏览器中创建 XMLHttpRequest，然而<code>fetch</code>是es规范中的实现方式，脱离了XMLHttpRequest，需要更多的配置。具体其他的区别需要在其他使用场景中去注意。</p><p>下面是两个方法的返回值的区别：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> files = [<span class="string">'./data/a.json'</span>, <span class="string">'./data/b.json'</span>]</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'fetch:'</span>, fetch(files[<span class="number">0</span>]))</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'axios:'</span>, axios.get(files[<span class="number">0</span>]))</span><br></pre></td></tr></table></figure><p>结果：</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fzdd499tbej30f20ct3yx.jpg" alt=""></p><p>可以看到两者的区别。</p><h3 id="实现异步-2"><a href="#实现异步-2" class="headerlink" title="实现异步"></a>实现异步</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> files = [<span class="string">'./data/a.json'</span>, <span class="string">'./data/b.json'</span>]</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">fetchFilesData</span>(<span class="params">files</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> promises = files.map(<span class="function">(<span class="params">file</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> axios.get(file) <span class="comment">// 得到一个返回response的promise</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">await</span> <span class="built_in">Promise</span>.all(promises)</span><br><span class="line">&#125;</span><br><span class="line">fetchFilesData(files).then(<span class="function">(<span class="params">results</span>) =&gt;</span> &#123; <span class="keyword">return</span> results.map(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123;<span class="keyword">return</span> result.data&#125;) &#125;)</span><br><span class="line">    .then(<span class="function">(<span class="params">data</span>) =&gt;</span> &#123;<span class="built_in">console</span>.log(data)&#125;)</span><br></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>对于不同实现方式的优点和缺点，以及原理尚还不是很清晰，特别是axios和fetch两者，还需要再多多学习。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h1&gt;&lt;p&gt;最近在使用js中经常遇到需要去异步获取文件并对文件内容进行处理的需求。&lt;/p&gt;
&lt;p&gt;详细的需求是：同时去异步获取多个文件，然后将多个文件的
      
    
    </summary>
    
      <category term="前端开发" scheme="http://shadowdsp.github.io/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="前端开发" scheme="http://shadowdsp.github.io/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
      <category term="问题记录" scheme="http://shadowdsp.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
      <category term="JavaScipt" scheme="http://shadowdsp.github.io/tags/JavaScipt/"/>
    
  </entry>
  
  <entry>
    <title>前端css样式覆盖问题</title>
    <link href="http://shadowdsp.github.io/2019/01/10/%E5%89%8D%E7%AB%AFcss%E6%A0%B7%E5%BC%8F%E8%A6%86%E7%9B%96/"/>
    <id>http://shadowdsp.github.io/2019/01/10/前端css样式覆盖/</id>
    <published>2019-01-10T15:42:58.000Z</published>
    <updated>2019-01-20T13:31:34.232Z</updated>
    
    <content type="html"><![CDATA[<h1 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h1><p>今天在使用 D3 的时候遇到一个 css 的问题，这里留作记录防止以后踩坑。</p><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>在使用 d3 添加鼠标响应事件，想要修改 css，结果不会修改。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> rec = svg.append(<span class="string">"rect"</span>)</span><br><span class="line">  .attr(<span class="string">"class"</span>, <span class="string">"view"</span>)</span><br><span class="line">  .attr(<span class="string">"x"</span>, <span class="number">1</span>)</span><br><span class="line">  .attr(<span class="string">"y"</span>, <span class="number">1</span>)</span><br><span class="line">  .attr(<span class="string">"width"</span>, width - <span class="number">2</span>)</span><br><span class="line">  .attr(<span class="string">"height"</span>, height - <span class="number">2</span>)</span><br><span class="line">  .attr(<span class="string">"fill"</span>, <span class="string">"gray"</span>)</span><br><span class="line">  .style(<span class="string">"stroke"</span>, <span class="string">"red"</span>)</span><br><span class="line">  .style(<span class="string">"stroke-width"</span>, <span class="string">"2px"</span>)</span><br><span class="line">  .on(<span class="string">"mouseover"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    d3.select(<span class="keyword">this</span>).classed(<span class="string">"hover"</span>, <span class="literal">true</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .on(<span class="string">"mouseout"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">    d3.select(<span class="keyword">this</span>).classed(<span class="string">"hover"</span>, <span class="literal">false</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.view</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">stroke</span>: blue;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.view</span> &#123;</span><br><span class="line">  <span class="attribute">stroke</span>: gold;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这里添加了 <code>mouseover</code> 和 <code>mouseout</code> 事件，借此改变 <code>rect</code> 的样式，结果没有成功。</p><h1 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h1><p>折腾了好久，问了一下大佬立马解决。</p><p>打开 chrome 的调试工具。</p><p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fz1wr31s8yj30v20t6jws.jpg" alt="chrome"></p><p>可以看到这里 <code>.view:hover</code> 和 <code>.view</code> 都是被 <code>element.style</code> 覆盖了。</p><p>这个 <code>element.style</code> 一般是内联样式，因此查看自己的代码，发现在定义 <code>rect</code> 的时候已经定义了 <code>style</code> ： <code>.style(&quot;stroke&quot;, &quot;red&quot;).style(&quot;stroke-width&quot;, &quot;2px&quot;)</code>。</p><p>将这两句去掉，可以得到最终结果：</p><blockquote><p>hover</p></blockquote><p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fz1wxcf7m0j306y06ct8k.jpg" alt="hover"></p><blockquote><p>unhover</p></blockquote><p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fz1wxja7ajj306806aq2s.jpg" alt="unhover"></p><h1 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h1><blockquote><p>D3Component.js</p></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> d3 <span class="keyword">from</span> <span class="string">'d3'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./D3Component.css'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">D3Component</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">let</span> svg = d3.select(<span class="string">"svg"</span>),</span><br><span class="line">      width = +svg.attr(<span class="string">"width"</span>),</span><br><span class="line">      height = +svg.attr(<span class="string">"height"</span>);</span><br><span class="line">    <span class="keyword">let</span> rec = svg.append(<span class="string">"rect"</span>)</span><br><span class="line">      .attr(<span class="string">"class"</span>, <span class="string">"view"</span>)</span><br><span class="line">      .attr(<span class="string">"x"</span>, <span class="number">1</span>)</span><br><span class="line">      .attr(<span class="string">"y"</span>, <span class="number">1</span>)</span><br><span class="line">      .attr(<span class="string">"width"</span>, width - <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">"height"</span>, height - <span class="number">2</span>)</span><br><span class="line">      .attr(<span class="string">"fill"</span>, <span class="string">"gray"</span>)</span><br><span class="line">      <span class="comment">// .style("stroke", "red")</span></span><br><span class="line">      <span class="comment">// .style("stroke-width", "2px")</span></span><br><span class="line">      .on(<span class="string">"mouseover"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        d3.select(<span class="keyword">this</span>).classed(<span class="string">"hover"</span>, <span class="literal">true</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">      .on(<span class="string">"mouseout"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">        d3.select(<span class="keyword">this</span>).classed(<span class="string">"hover"</span>, <span class="literal">false</span>)</span><br><span class="line">      &#125;)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;svg id=<span class="string">"svg"</span> width=<span class="string">"100"</span> height=<span class="string">"100"</span>&gt;&lt;/svg&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default D3Component;</span></span><br></pre></td></tr></table></figure><blockquote><p>D3Component.css</p></blockquote><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.view</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">stroke</span>: blue;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.view</span> &#123;</span><br><span class="line">  <span class="attribute">stroke</span>: gold;</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">2</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;综述&quot;&gt;&lt;a href=&quot;#综述&quot; class=&quot;headerlink&quot; title=&quot;综述&quot;&gt;&lt;/a&gt;综述&lt;/h1&gt;&lt;p&gt;今天在使用 D3 的时候遇到一个 css 的问题，这里留作记录防止以后踩坑。&lt;/p&gt;
&lt;h1 id=&quot;问题&quot;&gt;&lt;a href=&quot;#问题&quot; c
      
    
    </summary>
    
      <category term="前端开发" scheme="http://shadowdsp.github.io/categories/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="前端开发" scheme="http://shadowdsp.github.io/tags/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/"/>
    
      <category term="问题记录" scheme="http://shadowdsp.github.io/tags/%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/"/>
    
      <category term="CSS" scheme="http://shadowdsp.github.io/tags/CSS/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://shadowdsp.github.io/2018/12/15/Hello-World/"/>
    <id>http://shadowdsp.github.io/2018/12/15/Hello-World/</id>
    <published>2018-12-15T09:15:24.000Z</published>
    <updated>2018-12-15T09:33:48.666Z</updated>
    
    <content type="html"><![CDATA[<p>本人是广东某双非本科的计算机系蒟蒻一枚，大一到大三接触过ACM，之后开始接触Java备战春招，暑假在杭州实习。虽然秋招以Java后台开发为目标，但是去了广州某无人驾驶公司，主要使用Python（学了一年的Java最终丢了233）。之前一直是用博客园和简书写一些东西，前两周入职了，开始接触新的东西，建立这个博客也算是新的启程吧。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;本人是广东某双非本科的计算机系蒟蒻一枚，大一到大三接触过ACM，之后开始接触Java备战春招，暑假在杭州实习。虽然秋招以Java后台开发为目标，但是去了广州某无人驾驶公司，主要使用Python（学了一年的Java最终丢了233）。之前一直是用博客园和简书写一些东西，前两周
      
    
    </summary>
    
      <category term="生活" scheme="http://shadowdsp.github.io/categories/%E7%94%9F%E6%B4%BB/"/>
    
    
      <category term="生活" scheme="http://shadowdsp.github.io/tags/%E7%94%9F%E6%B4%BB/"/>
    
  </entry>
  
</feed>
